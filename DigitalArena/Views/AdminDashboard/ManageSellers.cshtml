@model List<DigitalArena.Models.UserModel>

@{
    ViewBag.Title = "Sellers List";
}

<nav aria-label="breadcrumb" class="mb-4">
    <ol class="breadcrumb bg-white px-3 py-2 rounded shadow-sm">
        <li class="breadcrumb-item">
            <a href="@Url.Action("Index", "AdminDashboard")" class="text-decoration-none text-dark">Admin</a>
        </li>
        <li class="breadcrumb-item active text-primary" aria-current="page">
            Manage Sellers
        </li>
    </ol>
</nav>

<h1 class="mb-1 fw-bold text-primary">Sellers Management</h1>
<p class="text-muted mb-4">Browse and manage all registered sellers</p>

<div class="table-responsive">
    <div class="row mb-3 g-3 align-items-end">
        <div class="col-md-4">
            <label for="searchTerm" class="form-label">Search</label>
            <input id="searchTerm" class="form-control" placeholder="Username, Email, Name" />
        </div>
        <div class="col-md-3">
            <label for="statusFilter" class="form-label">Status</label>
            <select id="statusFilter" class="form-select">
                <option value="">All</option>
                <option value="active">Active</option>
                <option value="inactive">Inactive</option>
            </select>
        </div>
        <div class="col-md-2 d-flex align-items-center">
            <button id="clearFilters" class="btn btn-outline-secondary w-100">Clear Filters</button>
        </div>
    </div>

    <div id="sellersTableContainer">
        @Html.Partial("_SellersTable", Model)
    </div>
</div>

<a href="@Url.Action("Index", "AdminDashboard")" class="btn btn-secondary mt-3">Back to Dashboard</a>

@section scripts {
    <script>
        $(document).ready(function () {
            let timer;

            $('#searchTerm, #statusFilter').on('input change', function () {
                clearTimeout(timer);
                timer = setTimeout(fetchFilteredSellers, 400);
            });

            $('#clearFilters').on('click', function (e) {
                e.preventDefault();
                $('#searchTerm').val('');
                $('#statusFilter').val('');
                fetchFilteredSellers(1);
            });

            function fetchFilteredSellers(page = 1) {
                $.get('@Url.RouteUrl("ManageSellersRoute")', {
                    page,
                    search: $('#searchTerm').val(),
                    status: $('#statusFilter').val()
                }).done(function (data) {
                    $('#sellersTableContainer').html(data);
                });
            }

            $(document).on('click', '.pagination a.page-link', function (e) {
                e.preventDefault();
                const page = $(this).data('page');
                fetchFilteredSellers(page);
            });
        });
    </script>
}
